<!DOCTYPE html><html class="theme-lattice"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><title>canvas 图像旋转与翻转姿势解锁 | Aotu.io「凹凸实验室」</title><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="author" content="凹凸实验室"><meta name="designer" content="凹凸实验室"><meta name="rating" content="general"><meta name="format-detection" content="telephone=yes"><meta name="robots" content="index, follow"><meta baidu-gxt-verify-token="2b74a5aea155a215abea8547f929190c"><meta name="keywords" content="transform,坐标系,矩阵变换,图像翻转,图像旋转,canvas,凹凸实验室,Aotu,前端开发,全栈开发,IOS开发,Android开发"><link rel="canonical" href="https://aotu.io/notes/2017/05/25/canvas-img-rotate-and-flip/index.html"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png"><link rel="icon" type="image/png" sizes="48x48" href="/img/favicon-48x48.png"><link rel="manifest" href="/img/manifest.json"><meta name="mobile-web-app-capable" content="yes"><meta name="theme-color" content="#2f83cd"><meta name="application-name" content="Aotu.io"><link rel="apple-touch-icon" sizes="57x57" href="/img/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/img/apple-touch-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/img/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/img/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/img/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/img/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/img/apple-touch-icon-152x152.png"><link rel="apple-touch-icon" sizes="167x167" href="/img/apple-touch-icon-167x167.png"><link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon-180x180.png"><link rel="apple-touch-icon" sizes="1024x1024" href="/img/apple-touch-icon-1024x1024.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-title" content="Aotu.io"><meta name="msapplication-TileColor" content="#fff"><meta name="msapplication-TileImage" content="/img/mstile-144x144.png"><meta name="msapplication-config" content="/img/browserconfig.xml"><meta property="wb:webmaster" content="a1686eb81db284d5"><link rel="dns-prefetch" href="//storage.360buyimg.com"><link rel="dns-prefetch" href="//img10.360buyimg.com"><link rel="dns-prefetch" href="//img11.360buyimg.com"><link rel="dns-prefetch" href="//img12.360buyimg.com"><link rel="dns-prefetch" href="//img13.360buyimg.com"><link rel="dns-prefetch" href="//img14.360buyimg.com"><link rel="dns-prefetch" href="//img20.360buyimg.com"><link rel="dns-prefetch" href="//img30.360buyimg.com"><link rel="dns-prefetch" href="//misc.aotu.io"><link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css"><link rel="stylesheet" href="/css/style.css"><link rel="alternate" href="/atom.xml" title="Aotu.io"><meta name="description" content="多图预警，数学不好可直接跳至文末小结。  需求背景从一个游戏需求说起：  技术选型：canvas上图所展示的游戏场景，“可乐瓶”里有多个“气泡”，需要设置不同的动画效果，且涉及 deviceOrientation 的交互，需要有大量计算改变元素状态。从性能方面考虑，canvas 是不二的选择。 技术点：canvas 绘制图像通过对游戏场景的进一步分析，可见场景中的“气泡”元素形状都是相同的，且不"><meta name="keywords" content="canvas,图像旋转,图像翻转,矩阵变换,坐标系,transform"><meta property="og:type" content="article"><meta property="og:title" content="canvas 图像旋转与翻转姿势解锁"><meta property="og:url" content="https://aotu.io/notes/2017/05/25/canvas-img-rotate-and-flip/index.html"><meta property="og:site_name" content="Aotu.io"><meta property="og:description" content="多图预警，数学不好可直接跳至文末小结。  需求背景从一个游戏需求说起：  技术选型：canvas上图所展示的游戏场景，“可乐瓶”里有多个“气泡”，需要设置不同的动画效果，且涉及 deviceOrientation 的交互，需要有大量计算改变元素状态。从性能方面考虑，canvas 是不二的选择。 技术点：canvas 绘制图像通过对游戏场景的进一步分析，可见场景中的“气泡”元素形状都是相同的，且不"><meta property="og:locale" content="zh-cn"><meta property="og:image" content="https://misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/coke.png"><meta property="og:image" content="https://misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/bg.png"><meta property="og:image" content="https://misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/system.png"><meta property="og:image" content="https://misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/system_coke.png"><meta property="og:image" content="https://misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/drawImage.png"><meta property="og:image" content="https://misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/rotate_coke.png"><meta property="og:image" content="https://misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/rotate_coke_join.png"><meta property="og:image" content="https://misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/flip_coke.png"><meta property="og:image" content="https://misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/flip_coke_join_1.png"><meta property="og:image" content="https://misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/flip_coke_join_2.png"><meta property="og:image" content="https://misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/flip_coke_join_3.png"><meta property="og:image" content="https://misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/matrix.gif"><meta property="og:image" content="https://misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/matirix_translate.png"><meta property="og:image" content="https://misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/matirix_rotate.png"><meta property="og:image" content="https://misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/matirix_scale.png"><meta property="og:image" content="https://misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/matirix_skew.png"><meta property="og:image" content="https://misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/matirix_flip.png"><meta property="og:image" content="https://misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/matirix_rotate_coke.png"><meta property="og:image" content="https://misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/matirix_flip_coke.png"><meta property="og:image" content="https://misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/matirix_rotate_flip_coke.png"><meta property="og:updated_time" content="2020-04-28T03:04:50.299Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="canvas 图像旋转与翻转姿势解锁"><meta name="twitter:description" content="多图预警，数学不好可直接跳至文末小结。  需求背景从一个游戏需求说起：  技术选型：canvas上图所展示的游戏场景，“可乐瓶”里有多个“气泡”，需要设置不同的动画效果，且涉及 deviceOrientation 的交互，需要有大量计算改变元素状态。从性能方面考虑，canvas 是不二的选择。 技术点：canvas 绘制图像通过对游戏场景的进一步分析，可见场景中的“气泡”元素形状都是相同的，且不"><meta name="twitter:image" content="https://misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/coke.png"><meta name="twitter:site" content="o2circle"><script>var App={root:"/",isHome:!1,isCate:!1,isTag:!1}</script></head><body class="page-post-detail"><div class="mod-hd"><div class="grid"><div class="mod-logo"><a href="/index.html" title="Aotu.io">Aotu.io</a></div><span class="mod-hd-toggle" id="J_hdToggle"><i class="fa fa-bars"></i></span><div class="mod-hd-main"><div class="mod-hd-inner"><nav class="mod-nav"><ul class="mod-nav-list"><li class="main-nav-item"><a href="/index.html" class="main-nav-link">首页</a></li><li class="main-nav-item"><a target="_blank" href="https://geeks.aotu.io" class="main-nav-link">极客沙龙</a></li><li class="main-nav-item"><a href="https://cases.aotu.io" class="main-nav-link">H5案例</a></li><li class="main-nav-item"><a href="/about/" class="main-nav-link">关于</a></li><li class="main-nav-item"><a href="/join/" class="main-nav-link">加入我们</a></li></ul></nav><div class="mod-search" id="J_search"><a class="fa fa-search mod-search-ico" id="J_searchTrigger" title="搜索"></a><form id="J_searchForm" method="get" class="mod-search-form" action="/search/"><input type="text" name="query" class="mod-search-ipt" id="J_searchInput" placeholder="搜索"></form></div></div></div></div></div><div class="mod-container"><div class="grid"><div class="mod-main typo"><article class="post"><div class="post-cover"><img src="//misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/cover_900x500.png" alt="canvas 图像旋转与翻转姿势解锁"></div><header class="post-hd"><h1 class="post-tit">canvas 图像旋转与翻转姿势解锁</h1><div class="post-meta">by <a target="_blank" href="https://github.com/Yettyzyt" class="post-author">Yetty</a> on <span>2017-05-25</span></div><p class="post-subtit" style="display:none"><i class="fa fa-quote-left"></i>多图预警，数学不好可直接跳至文末小结。</p><span style="display:none" id="busuanzi_value_page_pv"></span></header><div class="post-content"><blockquote><p>多图预警，数学不好可直接跳至文末小结。</p></blockquote><h2 id="需求背景" class="post-heading"><a href="#需求背景" class="headerlink" title="需求背景"></a>需求背景<a class="post-anchor" href="#需求背景" aria-hidden="true"></a></h2><p>从一个游戏需求说起：<br><img src="//misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/coke.png" alt="需求背景"></p><ol><li>技术选型：canvas<br>上图所展示的游戏场景，“可乐瓶”里有多个“气泡”，需要设置不同的动画效果，且涉及 deviceOrientation 的交互，需要有大量计算改变元素状态。从性能方面考虑，canvas 是不二的选择。</li><li>技术点：canvas 绘制图像<br>通过对游戏场景的进一步分析，可见场景中的“气泡”元素形状都是相同的，且不规则，通过 canvas 直接绘制形状实现成本较高，因此需要在 canvas 上绘制图像。</li><li>技术点：canvas 图像旋转与翻转<br>虽然“气泡”元素是相同的，可以使用相同的图像，但图像需要多个角度/多个方向展示，因此需要对图像进行相应的旋转与翻转（镜像），这也是本文所要介绍的重点。</li></ol><p>后文代码以下图左侧绿框的“气泡”为示例，右侧展示了场景中用到的两个图像：<br><img src="//misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/bg.png" alt="需求背景"></p><h2 id="认识-canvas-坐标系" class="post-heading"><a href="#认识-canvas-坐标系" class="headerlink" title="认识 canvas 坐标系"></a>认识 canvas 坐标系<a class="post-anchor" href="#认识-canvas-坐标系" aria-hidden="true"></a></h2><p>canvas 上图像的旋转和翻转，常见的做法是将 canvas 坐标系统进行变换。因此，我们需要先认识 canvas 坐标系统：<br><img src="//misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/system.png" alt="canvas 坐标系"><br>由上图可得，canvas 2D 环境中坐标系统和 Web 的坐标系统是一致的，有以下几个特点：</p><ol><li>坐标原点 (0,0) 在左上角</li><li>X坐标向右方增长</li><li>Y坐标向下方延伸</li></ol><p>回到上述需求中，我们获取 canvas 对象并设置相应的宽高：<br></p><figure class="highlight htmlbars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">'myCanvas'</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取 canvas 对象</span></span><br><span class="line"><span class="keyword">var</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">'myCanvas'</span>)</span><br><span class="line">canvas.width = <span class="number">750</span></span><br><span class="line">canvas.height = <span class="number">1054</span></span><br><span class="line"><span class="comment">// 获取 canvas 2D 上下文对象</span></span><br><span class="line"><span class="keyword">var</span> ctx = canvas.getContext(<span class="string">'2d'</span>)</span><br></pre></td></tr></table></figure><p>此时，canvas 的坐标系统如下图所示：<br><img src="//misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/system_coke.png" alt="coke 坐标系"></p><h3 id="在-canvas-上绘制图像" class="post-heading"><a href="#在-canvas-上绘制图像" class="headerlink" title="在 canvas 上绘制图像"></a>在 canvas 上绘制图像<a class="post-anchor" href="#在-canvas-上绘制图像" aria-hidden="true"></a></h3><p>在 canvas 上绘制图像，可以使用 <code>drawImage()</code> 方法，语法如下（详细用法参见 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/drawImage" target="_blank" rel="noopener">MDN</a>）：<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> ctx.drawImage(image, dx, dy);</span><br><span class="line"><span class="keyword">void</span> ctx.drawImage(image, dx, dy, dWidth, dHeight);</span><br><span class="line"><span class="keyword">void</span> ctx.drawImage(image, sx, sy, sWidth, sHeight, dx, dy, dWidth, dHeight);</span><br></pre></td></tr></table></figure><p></p><p>需要注意的是，图像必须加载完毕，才能绘制到 canvas 上，否则会出现空白：<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> img = <span class="keyword">new</span> Image()</span><br><span class="line">img.src = <span class="string">'xxxxxxx.png'</span></span><br><span class="line">img.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="comment">// 绘制图像</span></span><br><span class="line">	ctx.drawImage(img, <span class="number">512</span>, <span class="number">220</span>, <span class="number">160</span>, <span class="number">192</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>此时，便可以 canvas 上看到一个未旋转/翻转的“气泡”图像，如下图所示：<br><img src="//misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/drawImage.png" alt="绘制图像"></p><h2 id="canvas-坐标变换" class="post-heading"><a href="#canvas-坐标变换" class="headerlink" title="canvas 坐标变换"></a>canvas 坐标变换<a class="post-anchor" href="#canvas-坐标变换" aria-hidden="true"></a></h2><p>接下来，我们再来了解 canvas 坐标的变换。上述需求仅涉及 2D 绘制上下文，因此仅介绍 2D 绘制上下文支持的各种变换：</p><ol><li><p>平移 translate：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctx.translate(x, y)</span><br></pre></td></tr></table></figure><p>translate() 方法接受两个参数。x 是左右偏移量，y 是上下偏移量。</p></li><li><p>旋转 rotate：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctx.rotate(angle)</span><br></pre></td></tr></table></figure><p>rotate() 方法只接受一个参数。旋转的角度 angle，它是顺时针方向的，以弧度为单位的值。</p></li><li><p>缩放 scale：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctx.scale(x, y)</span><br></pre></td></tr></table></figure><p>scale() 方法接受两个参数。x 和 y 分别是横轴和纵轴的缩放因子。其缩放因子默认是 1，如果比 1 小是缩小，如果比 1 大则放大。</p></li><li><p>变形 transform：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctx.transform (a, b, c, d, e, f)</span><br></pre></td></tr></table></figure><p>transform() 方法是对当前坐标系进行矩阵变换。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctx.setTransform (a, b, c, d, e, f)</span><br></pre></td></tr></table></figure><p>setTransform() 方法重置变形矩阵。先将当前的矩阵重置为单位矩阵（即默认的坐标系），再用相同的参数调用 transform() 方法设置矩阵。<br>以上两个方法均接受六个参数，具体如下：</p></li></ol><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>a</td><td>水平缩放绘图</td></tr><tr><td>b</td><td>水平倾斜绘图</td></tr><tr><td>c</td><td>垂直倾斜绘图</td></tr><tr><td>d</td><td>垂直缩放绘图</td></tr><tr><td>e</td><td>水平移动绘图</td></tr><tr><td>f</td><td>垂直移动绘图</td></tr></tbody></table><h2 id="图像旋转的实现" class="post-heading"><a href="#图像旋转的实现" class="headerlink" title="图像旋转的实现"></a>图像旋转的实现<a class="post-anchor" href="#图像旋转的实现" aria-hidden="true"></a></h2><p><img src="//misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/rotate_coke.png" alt="图像旋转"><br>上图所示“气泡”，宽为 160，高为 192，x 轴方向距离原点 512，y 轴方向距离原点 220，逆时针旋转 35 度。<br>要绘制该“气泡”，需要先将坐标系平移（translate），再旋转（rotate）。具体实现步骤如下：<br><img src="//misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/rotate_coke_join.png" alt="图像旋转"></p><blockquote><p>save() 方法与 restore() 方法：</p><ol><li>save() 方法用来保存 Canvas 状态的，没有参数。每一次调用 save() 方法，当前的状态就会被推入栈中保存起来。当前状态包括：<ul><li>当前应用的变形（移动/旋转/缩放）</li><li>strokeStyle, fillStyle, globalAlpha, lineWidth, lineCap, lineJoin, miterLimit, shadowOffsetX, shadowOffsetY, shadowBlur, shadowColor, globalCompositeOperation 的值</li><li>当前的裁切路径（clipping path）</li></ul></li><li>restore() 方法用来恢复 Canvas 状态，没有参数。每一次调用 restore() 方法，上一个保存的状态就从栈中弹出，所有设定都恢复。</li><li>状态保存在栈中，可以嵌套使用 save() 与 restore()。</li></ol></blockquote><h2 id="图像翻转的实现" class="post-heading"><a href="#图像翻转的实现" class="headerlink" title="图像翻转的实现"></a>图像翻转的实现<a class="post-anchor" href="#图像翻转的实现" aria-hidden="true"></a></h2><p><img src="//misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/flip_coke.png" alt="图像翻转"><br>上图所示“气泡”，宽为 160，高为 192，x 轴方向距离原点 172，y 轴方向距离原点 365，顺时针旋转 35 度。<br>要绘制该“气泡”，需要先将坐标系统平移（translate），翻转（scale），平移（translate），再旋转（rotate）。具体实现步骤如下：<br><img src="//misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/flip_coke_join_1.png" alt="图像翻转1"><br>至此，实现了“气泡”的镜像翻转，但翻转后的“气泡”还需要旋转特定的角度，在方法一的基础上继续对坐标系统进行变换：<br><img src="//misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/flip_coke_join_2.png" alt="图像翻转2"><br>以上操作中进行了两次平移（translate）操作，可以进行合并简化：<br><img src="//misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/flip_coke_join_3.png" alt="图像翻转3"></p><h2 id="坐标系统的矩阵变换" class="post-heading"><a href="#坐标系统的矩阵变换" class="headerlink" title="坐标系统的矩阵变换"></a>坐标系统的矩阵变换<a class="post-anchor" href="#坐标系统的矩阵变换" aria-hidden="true"></a></h2><p>前文介绍了 2D 绘制上下文变形（transform）变换，实际是直接修改变换的矩阵，它可以实现前面介绍的平移（translate）／旋转（rotate）／缩放（ scale）变换，还可以实现切变/镜像反射变换等。矩阵计算遵循数学矩阵公式规则：<br><img src="//misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/matrix.gif" alt="矩阵变换"><br>由上公式可得：<br></p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x' = ax + cy + e</span><br><span class="line">y' = bx + dy + f</span><br></pre></td></tr></table></figure><p></p><p>矩阵变换可实现以下变换效果：</p><ol><li><p>平移 translate：</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x' = <span class="number">1</span>x+<span class="number">0</span>y+tx = x+tx</span><br><span class="line">y' = <span class="number">0</span>x+<span class="number">1</span>y+ty = y+ty</span><br></pre></td></tr></table></figure><p><img src="//misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/matirix_translate.png" alt="平移"></p></li><li><p>旋转 rotate：</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x' = x*cosθ-y*sinθ+<span class="number">0</span> = x*cosθ-y*sinθ</span><br><span class="line">y' = x*sinθ+y*cosθ+<span class="number">0</span> = x*sinθ+y*cosθ</span><br></pre></td></tr></table></figure><p><img src="//misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/matirix_rotate.png" alt="旋转"></p></li><li><p>缩放 scale：</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x' = Sx*x+<span class="number">0</span>y+<span class="number">0</span> = Sx*x</span><br><span class="line">y' = <span class="number">0</span>x+Sy*y+<span class="number">0</span> = Sy*y</span><br></pre></td></tr></table></figure><p><img src="//misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/matirix_scale.png" alt="缩放和拉伸"></p></li><li><p>切变</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x' = x+y*tan(θx)+<span class="number">0</span> = x+y*tan(θx)</span><br><span class="line">y' = x*tan(θy)+y+<span class="number">0</span> = x*tan(θy)+y</span><br></pre></td></tr></table></figure><p><img src="//misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/matirix_skew.png" alt="切变"></p></li><li><p>镜像反射</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 定义(ux,uy)为直线(y=kx)方向的单位向量</span><br><span class="line">ux=<span class="number">1</span>/sqrt(<span class="number">1</span>+k^<span class="number">2</span>)</span><br><span class="line">uy=k/sqrt(<span class="number">1</span>+k^<span class="number">2</span>)</span><br><span class="line">x' = (<span class="number">2</span>*ux^<span class="number">2</span><span class="number">-1</span>)*x+<span class="number">2</span>*ux*uy*y</span><br><span class="line">y' = <span class="number">2</span>*ux*uy*x+(<span class="number">2</span>*uy^<span class="number">2</span><span class="number">-1</span>)*y</span><br></pre></td></tr></table></figure><p><img src="//misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/matirix_flip.png" alt="镜像反射"></p></li></ol><p>结合上述公式，可推导出图像旋转和翻转的矩阵变换实现：</p><ol><li>图像旋转：<br><img src="//misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/matirix_rotate_coke.png" alt="图像旋转"></li><li>图像翻转：<br><img src="//misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/matirix_flip_coke.png" alt="图像翻转"></li><li>图像镜像反射（翻转+旋转）：<br><img src="//misc.aotu.io/Yettyzyt/2017-05-25-canvas-img-rotate-and-flip/matirix_rotate_flip_coke.png" alt="图像旋转&amp;翻转"></li></ol><h2 id="像素操作实现图像翻转" class="post-heading"><a href="#像素操作实现图像翻转" class="headerlink" title="像素操作实现图像翻转"></a>像素操作实现图像翻转<a class="post-anchor" href="#像素操作实现图像翻转" aria-hidden="true"></a></h2><p>除了坐标系统变换，canvas 的像素操作同样可以实现图像的翻转。首先需要了解下 <code>getImageData()</code> 方法（详细用法参见<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/getImageData" target="_blank" rel="noopener">MDN</a>）和 <code>putImageData()</code>（详细用法参见<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/putImageData" target="_blank" rel="noopener">MDN</a>）方法：</p><ol><li><p>getImageData()<br><code>CanvasRenderingContext2D.getImageData()</code> 返回一个 ImageData 对象，用来描述 canvas 区域隐含的像素数据，这个区域通过矩形表示，起始点为 (sx, sy)、宽为 sw、高为 sh。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ImageData ctx.getImageData(sx, sy, sw, sh);</span><br></pre></td></tr></table></figure></li><li><p>putImageData()<br><code>CanvasRenderingContext2D.putImageData()</code> 是 Canvas 2D API 将数据从已有的 ImageData 对象绘制到位图的方法。 如果提供了脏矩形，只能绘制矩形的像素。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> ctx.putImageData(imagedata, dx, dy);</span><br><span class="line"><span class="keyword">void</span> ctx.putImageData(imagedata, dx, dy, dirtyX, dirtyY, dirtyWidth, dirtyHeight);</span><br></pre></td></tr></table></figure></li></ol><p>水平翻转实现：<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 绘制图像</span></span><br><span class="line">ctx.drawImage(img, x, y, width, height)</span><br><span class="line"><span class="comment">// 获取 img_data 数据</span></span><br><span class="line"><span class="keyword">var</span> img_data = ctx.getImageData(x, y, width, height),</span><br><span class="line">    i, i2, t,</span><br><span class="line">    h = img_data.height,</span><br><span class="line">    w = img_data.width,</span><br><span class="line">    w_2 = w / <span class="number">2</span>;</span><br><span class="line"><span class="comment">// 将 img_data 的数据水平翻转</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> dy = <span class="number">0</span>; dy &lt; h; dy ++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> dx = <span class="number">0</span>; dx &lt; w_2; dx ++) &#123;</span><br><span class="line">        i = (dy &lt;&lt; <span class="number">2</span>) * w + (dx &lt;&lt; <span class="number">2</span>)</span><br><span class="line">        i2 = ((dy + <span class="number">1</span>) &lt;&lt; <span class="number">2</span>) * w - ((dx + <span class="number">1</span>) &lt;&lt; <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> p = <span class="number">0</span>; p &lt; <span class="number">4</span>; p ++) &#123;</span><br><span class="line">            t = img_data.data[i + p]</span><br><span class="line">            img_data.data[i + p] = img_data.data[i2 + p]</span><br><span class="line">            img_data.data[i2 + p] = t</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 重绘水平翻转后的图片</span></span><br><span class="line">ctx.putImageData(img_data, x, y)</span><br></pre></td></tr></table></figure><p></p><h2 id="小结" class="post-heading"><a href="#小结" class="headerlink" title="小结"></a>小结<a class="post-anchor" href="#小结" aria-hidden="true"></a></h2><p>至此，小编的数学姿势又恢复到了高考水平。</p><ol><li><p>图像旋转：</p><ul><li><p>基础变换法：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ctx.save()</span><br><span class="line">ctx.translate(x + width / <span class="number">2</span>,  y + height / <span class="number">2</span>)</span><br><span class="line">ctx.rotate(angle * <span class="built_in">Math</span>.PI / <span class="number">180</span>)</span><br><span class="line">ctx.drawImage(img, -width / <span class="number">2</span>,  -height / <span class="number">2</span>, width, height)</span><br><span class="line">ctx.restore()</span><br></pre></td></tr></table></figure></li><li><p>矩阵变换法：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ctx.save()</span><br><span class="line"><span class="keyword">var</span> rad = angle * <span class="built_in">Math</span>.PI/<span class="number">180</span></span><br><span class="line">ctx.transform( <span class="built_in">Math</span>.cos(rad), <span class="built_in">Math</span>.sin(rad), -<span class="built_in">Math</span>.sin(rad), <span class="built_in">Math</span>.cos(rad), x + width / <span class="number">2</span>,  y + height / <span class="number">2</span>)</span><br><span class="line">ctx.drawImage(img, -width / <span class="number">2</span>,  -height / <span class="number">2</span>, width, height)</span><br><span class="line">ctx.restore()</span><br></pre></td></tr></table></figure></li></ul></li><li><p>图像翻转：</p><ul><li><p>基础变换法：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方法一</span></span><br><span class="line">ctx.save()</span><br><span class="line">ctx.translate(canvasWidth, <span class="number">0</span>)</span><br><span class="line">ctx.scale(<span class="number">-1</span>, <span class="number">1</span>)</span><br><span class="line">ctx.drawImage(img, canvasWidth-width-x, y, width, height)</span><br><span class="line">ctx.restore()</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方法二</span></span><br><span class="line">ctx.save()</span><br><span class="line">ctx.scale(<span class="number">-1</span>, <span class="number">1</span>)</span><br><span class="line">ctx.drawImage(img, -width-x, y, width, height)</span><br><span class="line">ctx.restore()</span><br></pre></td></tr></table></figure></li><li><p>矩阵变换法：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方法一</span></span><br><span class="line">ctx.save()</span><br><span class="line">ctx.transform(<span class="number">-1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, canvasWidth, <span class="number">0</span>)</span><br><span class="line">ctx.drawImage(img, canvasWidth-width-x, y, width, height)</span><br><span class="line">ctx.restore()</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方法二</span></span><br><span class="line">ctx.save()</span><br><span class="line">ctx.transform(<span class="number">-1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">ctx.drawImage(img, -width-x, y, width, height)</span><br><span class="line">ctx.restore()</span><br></pre></td></tr></table></figure></li><li><p>像素操作法：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ctx.drawImage(img, x, y, width, height)</span><br><span class="line"><span class="keyword">var</span> img_data = ctx.getImageData(x, y, width, height),</span><br><span class="line">    i, i2, t,</span><br><span class="line">    h = img_data.height,</span><br><span class="line">    w = img_data.width,</span><br><span class="line">    w_2 = w / <span class="number">2</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> dy = <span class="number">0</span>; dy &lt; h; dy ++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> dx = <span class="number">0</span>; dx &lt; w_2; dx ++) &#123;</span><br><span class="line">        i = (dy &lt;&lt; <span class="number">2</span>) * w + (dx &lt;&lt; <span class="number">2</span>)</span><br><span class="line">        i2 = ((dy + <span class="number">1</span>) &lt;&lt; <span class="number">2</span>) * w - ((dx + <span class="number">1</span>) &lt;&lt; <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> p = <span class="number">0</span>; p &lt; <span class="number">4</span>; p ++) &#123;</span><br><span class="line">            t = img_data.data[i + p]</span><br><span class="line">            img_data.data[i + p] = img_data.data[i2 + p]</span><br><span class="line">            img_data.data[i2 + p] = t</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">ctx.putImageData(img_data, x, y)</span><br></pre></td></tr></table></figure></li></ul></li><li><p>图像镜像对称（翻转+旋转）：</p><ul><li><p>基础变换法：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ctx.save()</span><br><span class="line">ctx.scale(<span class="number">-1</span>, <span class="number">1</span>)</span><br><span class="line">ctx.translate(-width/<span class="number">2</span>-x, y+height/<span class="number">2</span>) </span><br><span class="line">ctx.rotate(-angle * <span class="built_in">Math</span>.PI / <span class="number">180</span>)</span><br><span class="line">ctx.drawImage(img, -width / <span class="number">2</span>,  -height / <span class="number">2</span>, width, height)</span><br><span class="line">ctx.restore()</span><br></pre></td></tr></table></figure></li><li><p>矩阵变换法：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ctx.save()</span><br><span class="line"><span class="keyword">var</span> k = <span class="built_in">Math</span>.tan( (<span class="number">180</span>-angle)/<span class="number">2</span> * <span class="built_in">Math</span>.PI / <span class="number">180</span> )</span><br><span class="line"><span class="keyword">var</span> ux = <span class="number">1</span> / <span class="built_in">Math</span>.sqrt(<span class="number">1</span> + k * k)</span><br><span class="line"><span class="keyword">var</span> uy = k / <span class="built_in">Math</span>.sqrt(<span class="number">1</span> + k * k)</span><br><span class="line">ctx.transform( (<span class="number">2</span>*ux*ux<span class="number">-1</span>), <span class="number">2</span>*ux*uy, <span class="number">2</span>*ux*uy, (<span class="number">2</span>*uy*uy<span class="number">-1</span>), x + width/<span class="number">2</span>, y + height/<span class="number">2</span> )</span><br><span class="line">ctx.drawImage(img, -width/<span class="number">2</span>, -height/<span class="number">2</span>, width, height)</span><br><span class="line">ctx.restore()</span><br></pre></td></tr></table></figure></li></ul></li></ol><h2 id="参考文章" class="post-heading"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章<a class="post-anchor" href="#参考文章" aria-hidden="true"></a></h2><ul><li><a href="https://www.w3cplus.com/blog/tags/604.html" target="_blank" rel="noopener">《W3cplus - CANVAS 系列》</a></li><li><a href="http://sumsung753.blog.163.com/blog/static/146364501201281311522752/" target="_blank" rel="noopener">《html5 canvas.transform[转]》</a></li><li><a href="https://www.gitbook.com/book/oxcow/h5-canvas-study-notes" target="_blank" rel="noopener">《html5 canvas 学习笔记》</a></li><li><a href="https://blog.oldj.net/2011/02/09/flip-images-in-html5/" target="_blank" rel="noopener">《在HTML5中翻转图片》</a></li></ul><blockquote><p>说明：本文讨论的 canvas 环境均为 2D 环境。若有更好的实现方式，欢迎留言告知。</p></blockquote><div class="post-tags" style="display:none"><a href="/tags/canvas/">canvas</a> <a href="/tags/图像旋转/">图像旋转</a> <a href="/tags/图像翻转/">图像翻转</a> <a href="/tags/矩阵变换/">矩阵变换</a> <a href="/tags/坐标系/">坐标系</a> <a href="/tags/transform/">transform</a></div><div class="post-categories" style="display:none"><a href="/cates/Web开发/">Web开发</a></div><div class="post-announce">感谢您的阅读，本文由 <a href="//aotu.io">凹凸实验室</a> 版权所有。如若转载，请注明出处：凹凸实验室（<a href="https://aotu.io/notes/2017/05/25/canvas-img-rotate-and-flip/">https://aotu.io/notes/2017/05/25/canvas-img-rotate-and-flip/</a>）</div><div class="post-revision"><i class="fa fa-clock-o"></i> <time class="post-updated" datetime="2020-04-28T03:04:50.299Z">上次更新：2020-04-28 11:04:50</time></div></div><div class="post-nav"><div class="post-nav-next"><a href="/notes/2017/06/09/ps-tricks/" title="10个你可能不知道的前端PS技巧">10个你可能不知道的前端PS技巧 <i class="fa fa-chevron-right"></i></a></div><div class="post-nav-prev"><a href="/notes/2017/05/04/example-for-svg-animation/" title="一个例子上手SVG动画"><i class="fa fa-chevron-left"></i> 一个例子上手SVG动画</a></div></div><div class="post-comments" id="comments"></div><script>var gitalkOpts={id:"bm90ZXMvMjAxNy8wNS8yNS9jYW52YXMtaW1nLXJvdGF0ZS1hbm",owner:"o2team",repo:"o2team.github.io",title:"canvas 图像旋转与翻转姿势解锁",body:"https://aotu.io/notes/2017/05/25/canvas-img-rotate-and-flip/index.html\n\n多图预警，数学不好可直接跳至文末小结。",clientID:"3c4d153e6874260f9c7e",clientSecret:"dd44012504c6168bc05b9266e0554bb28c62ce15",admin:["Yettyzyt"]}</script></article></div><aside class="mod-side" id="sidebar"><div class="mod-side-sec aotuwx"><img class="aotuwx-qrcode" src="/img/qrcode.jpg" alt="关注我们"><div class="aotuwx-slogan">每周推送精选技术文章</div></div><div class="mod-side-sec works"><div class="mod-side-sec-hd"><h2>服务/产品</h2></div><div class="mod-side-sec-bd"><ul class="mod-side-list"><li><a href="//taro.jd.com" target="_blank" title="Taro">Taro</a></li><li><a href="//taro-ui.jd.com" target="_blank" title="Taro-UI">Taro-UI</a></li><li><a href="//taro-ext.jd.com" target="_blank" title="Taro 物料市场">Taro 物料市场</a></li><li><a href="//taro-club.jd.com" target="_blank" title="Taro 官方论坛">Taro 官方论坛</a></li><li><a href="//cases.aotu.io/mobi/maga.html" target="_blank" title="拇指期刊">拇指期刊</a></li><li><a href="//athena.aotu.io/" target="_blank" title="Athena">Athena</a></li><li><a href="//guide.aotu.io/" target="_blank" title="前端代码规范">前端代码规范</a></li><li><a href="//halojs.aotu.io/" target="_blank" title="HaloJS">HaloJS</a></li><li><a href="//sign.aotu.io/" target="_blank" title="邮件签名工具">邮件签名工具</a></li><li><a href="//mac.aotu.io/" target="_blank" title="MAC全栈环境">MAC全栈环境</a></li><li><a href="//xcel.aotu.io" target="_blank" title="Excel Filter">Excel Filter</a></li><li><a href="//aotu.jd.com/share/" target="_blank" title="凹凸公开课">凹凸公开课</a></li><li><a href="//at.aotu.io" target="_blank" title="AT-UI">AT-UI</a></li></ul></div></div><div class="mod-side-sec favlinks"><div class="mod-side-sec-hd"><h2>友情链接</h2></div><div class="mod-side-sec-bd"><ul class="mod-side-list"><li><a href="https://www.cloudbase.net" target="_blank" title="小程序·云开发"><img style="width:22px;vertical-align:middle" src="https://img20.360buyimg.com/ling/jfs/t1/57175/5/15617/50216/5dca6729E00cdff5d/631622525425290e.png">小程序·云开发</a></li><li><a href="https://ling.jd.com" target="_blank" title="京东羚珑智能设计">羚珑智能设计</a></li><li><a href="https://jdc.jd.com" target="_blank" title="京东设计中心">JDC京东设计中心</a></li><li><a href="http://dopro.io/" target="_blank" title="腾讯 Deep Ocean">Deep Ocean</a></li><li><a href="http://fex.baidu.com" target="_blank" title="百度Web前端研发部">百度FEX</a></li><li><a href="http://taobaofed.org" target="_blank" title="淘宝前端团队">淘宝FED</a></li><li><a href="http://tgideas.qq.com" target="_blank" title="腾讯互娱设计中心">TGIdeas</a></li><li><a href="http://isux.tencent.com" target="_blank" title="腾讯SNG设计中心">ISUX</a></li><li><a href="http://cdc.tencent.com" target="_blank" title="腾讯用户研究与体验设计中心">CDC</a></li><li><a href="http://ued.ctrip.com" target="_blank" title="携程设计委员会">携程UED</a></li><li><a href="https://uiiiuiii.com/" target="_blank" title="优优教程网">优优教程网</a></li><li><a href="https://www.designup.cn/" target="_blank" title="Designup">Designup</a></li><li><a href="http://eux.baidu.com/" target="_blank" title="百度EUX">百度EUX</a></li></ul></div></div></aside></div></div><div class="mod-backtop" id="backTop"><i class="fa fa-long-arrow-up"></i></div><footer class="mod-ft" id="footer"><div class="grid"><ul class="mod-ft-links"><li><a href="/atom.xml"><i class="fa fa-rss"></i></a></li><li><a href="https://github.com/o2team/o2team.github.io" target="_blank"><i class="fa fa-github-alt"></i></a></li></ul><div class="mod-ft-sec mod-ft-copyright"><p>Designed by <a href="http://aotu.io" target="_blank">凹凸实验室</a> @<a target="_blank" href="http://jdc.jd.com">京东用户体验设计部</a></p><p>Copyright &copy; 2020. All Rights Reserved.</p><p><a href="http://www.miibeian.gov.cn/" target="_blank">粤ICP备15077732号-2</a></p></div></div></footer><script src="/js/bundle/core.js"></script><script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script><script src="/js/post_wx_share.js"></script><script src="/js/bundle/gitalk.js"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="//hm.baidu.com/hm.js?e850b980d029480b092fdd7503c3f8de";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script type="text/javascript" src="https://tajs.qq.com/stats?sId=53685723" charset="UTF-8"></script></body></html>