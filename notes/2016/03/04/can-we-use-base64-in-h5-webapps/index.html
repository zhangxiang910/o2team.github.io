<!DOCTYPE html><html class="theme-lattice"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><title>图片资源Base64化在H5页面里有用武之地吗？ | Aotu.io「凹凸实验室」</title><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="author" content="凹凸实验室"><meta name="designer" content="凹凸实验室"><meta name="rating" content="general"><meta name="format-detection" content="telephone=yes"><meta name="robots" content="index, follow"><meta baidu-gxt-verify-token="2b74a5aea155a215abea8547f929190c"><meta name="keywords" content="h5,base64,凹凸实验室,Aotu,前端开发,全栈开发,IOS开发,Android开发"><link rel="canonical" href="https://aotu.io/notes/2016/03/04/can-we-use-base64-in-h5-webapps/index.html"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png"><link rel="icon" type="image/png" sizes="48x48" href="/img/favicon-48x48.png"><link rel="manifest" href="/img/manifest.json"><meta name="mobile-web-app-capable" content="yes"><meta name="theme-color" content="#2f83cd"><meta name="application-name" content="Aotu.io"><link rel="apple-touch-icon" sizes="57x57" href="/img/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/img/apple-touch-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/img/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/img/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/img/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/img/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/img/apple-touch-icon-152x152.png"><link rel="apple-touch-icon" sizes="167x167" href="/img/apple-touch-icon-167x167.png"><link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon-180x180.png"><link rel="apple-touch-icon" sizes="1024x1024" href="/img/apple-touch-icon-1024x1024.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-title" content="Aotu.io"><meta name="msapplication-TileColor" content="#fff"><meta name="msapplication-TileImage" content="/img/mstile-144x144.png"><meta name="msapplication-config" content="/img/browserconfig.xml"><meta property="wb:webmaster" content="a1686eb81db284d5"><link rel="dns-prefetch" href="//storage.360buyimg.com"><link rel="dns-prefetch" href="//img10.360buyimg.com"><link rel="dns-prefetch" href="//img11.360buyimg.com"><link rel="dns-prefetch" href="//img12.360buyimg.com"><link rel="dns-prefetch" href="//img13.360buyimg.com"><link rel="dns-prefetch" href="//img14.360buyimg.com"><link rel="dns-prefetch" href="//img20.360buyimg.com"><link rel="dns-prefetch" href="//img30.360buyimg.com"><link rel="dns-prefetch" href="//misc.aotu.io"><link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css"><link rel="stylesheet" href="/css/style.css"><link rel="alternate" href="/atom.xml" title="Aotu.io"><meta name="description" content="将图片资源转至base64格式后可直接放入页面作为首屏直出，也可以放入css文件中，减少请求，以加快首屏的呈现速度。不过图片base64化，将带来一个臃肿的html或css文件，是否会影响页面的渲染性能，浏览器又支持如何呢？ 如何统计？ 通过Navigation Timing记录的关键时间点来统计页面完成所用的时间，并通过Chrome开发工具来跟踪细节  12345var timing = win"><meta name="keywords" content="base64,h5"><meta property="og:type" content="article"><meta property="og:title" content="图片资源Base64化在H5页面里有用武之地吗？"><meta property="og:url" content="https://aotu.io/notes/2016/03/04/can-we-use-base64-in-h5-webapps/index.html"><meta property="og:site_name" content="Aotu.io"><meta property="og:description" content="将图片资源转至base64格式后可直接放入页面作为首屏直出，也可以放入css文件中，减少请求，以加快首屏的呈现速度。不过图片base64化，将带来一个臃肿的html或css文件，是否会影响页面的渲染性能，浏览器又支持如何呢？ 如何统计？ 通过Navigation Timing记录的关键时间点来统计页面完成所用的时间，并通过Chrome开发工具来跟踪细节  12345var timing = win"><meta property="og:locale" content="zh-cn"><meta property="og:image" content="https://img10.360buyimg.com/ling/jfs/t1/60942/35/2315/506501/5d09e94fEcf00b0ee/026ef7ade10bfc77.png"><meta property="og:image" content="https://img14.360buyimg.com/ling/jfs/t1/40929/14/6963/34473/5d09e967Ead9ecea2/4a2924c60152afb3.png"><meta property="og:image" content="https://img10.360buyimg.com/ling/jfs/t1/64822/24/2328/33611/5d09e981E98c27128/6640b7872ee33c70.png"><meta property="og:image" content="https://img14.360buyimg.com/ling/jfs/t1/47665/35/2809/35245/5d09e99cE727ed7b9/a74dee014fdbb6d8.png"><meta property="og:image" content="https://img10.360buyimg.com/ling/jfs/t1/37113/3/12618/34429/5d09e9aeEe8d8bd6d/60029ff04aa43c5c.png"><meta property="og:image" content="https://img13.360buyimg.com/ling/jfs/t1/50988/36/2826/32577/5d09e9c2E6e60566e/4b3823c5550e3e95.png"><meta property="og:image" content="https://img14.360buyimg.com/ling/jfs/t1/67837/13/2312/28633/5d09e9d6Ed242232d/cc7a68c662172862.png"><meta property="og:image" content="https://img13.360buyimg.com/ling/jfs/t1/44335/24/6976/44212/5d09e9ebEc794676b/741d84bef8e6b762.png"><meta property="og:image" content="https://img30.360buyimg.com/ling/jfs/t1/83973/8/2300/68259/5d09ea08Ee9a00498/2c7ef6abbab64452.png"><meta property="og:image" content="https://img20.360buyimg.com/ling/jfs/t1/80762/39/2369/68288/5d09ea1eEc24db889/eb1630b74fb7cf74.png"><meta property="og:image" content="https://img12.360buyimg.com/ling/jfs/t1/75863/30/2285/87027/5d09ea32E5ab77220/129a8c98f2e044ac.png"><meta property="og:image" content="https://img20.360buyimg.com/ling/jfs/t1/48464/32/2768/84493/5d09ea44E15fbc8b8/ab8ec033c28ac6b4.png"><meta property="og:image" content="https://img12.360buyimg.com/ling/jfs/t1/49305/12/2852/29446/5d09ea59E5b71c578/b19029313815f1cf.png"><meta property="og:image" content="https://img10.360buyimg.com/ling/jfs/t1/77240/40/2229/63120/5d09ea6eE133b4fe4/3d310d7007ce1754.png"><meta property="og:updated_time" content="2020-04-28T03:04:50.291Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="图片资源Base64化在H5页面里有用武之地吗？"><meta name="twitter:description" content="将图片资源转至base64格式后可直接放入页面作为首屏直出，也可以放入css文件中，减少请求，以加快首屏的呈现速度。不过图片base64化，将带来一个臃肿的html或css文件，是否会影响页面的渲染性能，浏览器又支持如何呢？ 如何统计？ 通过Navigation Timing记录的关键时间点来统计页面完成所用的时间，并通过Chrome开发工具来跟踪细节  12345var timing = win"><meta name="twitter:image" content="https://img10.360buyimg.com/ling/jfs/t1/60942/35/2315/506501/5d09e94fEcf00b0ee/026ef7ade10bfc77.png"><meta name="twitter:site" content="o2circle"><script>var App={root:"/",isHome:!1,isCate:!1,isTag:!1}</script></head><body class="page-post-detail"><div class="mod-hd"><div class="grid"><div class="mod-logo"><a href="/index.html" title="Aotu.io">Aotu.io</a></div><span class="mod-hd-toggle" id="J_hdToggle"><i class="fa fa-bars"></i></span><div class="mod-hd-main"><div class="mod-hd-inner"><nav class="mod-nav"><ul class="mod-nav-list"><li class="main-nav-item"><a href="/index.html" class="main-nav-link">首页</a></li><li class="main-nav-item"><a target="_blank" href="https://geeks.aotu.io" class="main-nav-link">极客沙龙</a></li><li class="main-nav-item"><a href="https://cases.aotu.io" class="main-nav-link">H5案例</a></li><li class="main-nav-item"><a href="/about/" class="main-nav-link">关于</a></li><li class="main-nav-item"><a href="/join/" class="main-nav-link">加入我们</a></li></ul></nav><div class="mod-search" id="J_search"><a class="fa fa-search mod-search-ico" id="J_searchTrigger" title="搜索"></a><form id="J_searchForm" method="get" class="mod-search-form" action="/search/"><input type="text" name="query" class="mod-search-ipt" id="J_searchInput" placeholder="搜索"></form></div></div></div></div></div><div class="mod-container"><div class="grid"><div class="mod-main typo"><article class="post"><div class="post-cover"><img src="https://img12.360buyimg.com/ling/jfs/t1/84687/37/2706/41340/5d09e939Efd413a9f/4ca7b50baedd3fbb.jpg" alt="图片资源Base64化在H5页面里有用武之地吗？"></div><header class="post-hd"><h1 class="post-tit">图片资源Base64化在H5页面里有用武之地吗？</h1><div class="post-meta">by <a target="_blank" href="https://github.com/Simbachen" class="post-author">Simba</a> on <span>2016-03-04</span></div><p class="post-subtit" style="display:none"><i class="fa fa-quote-left"></i>本文使用performance接口和Timeline工具，测试和分析了不同场景下引用base64化的图片资源对渲染性能的影响，旨在抛砖引玉，找出图片资源的base64化在H5应用中使用的可行性。</p><span style="display:none" id="busuanzi_value_page_pv"></span></header><div class="post-content"><p>将图片资源转至base64格式后可直接放入页面作为首屏直出，也可以放入css文件中，减少请求，以加快首屏的呈现速度。<br>不过图片base64化，将带来一个臃肿的html或css文件，是否会影响页面的渲染性能，浏览器又支持如何呢？</p><h3 id="如何统计？" class="post-heading"><a href="#如何统计？" class="headerlink" title="如何统计？"></a>如何统计？<a class="post-anchor" href="#如何统计？" aria-hidden="true"></a></h3><blockquote><p>通过Navigation Timing记录的关键时间点来统计页面完成所用的时间，并通过Chrome开发工具来跟踪细节</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> timing = <span class="built_in">window</span>.performance.timing</span><br><span class="line">timing.domLoading  <span class="comment">//浏览器开始解析 HTML 文档第一批收到的字节</span></span><br><span class="line">timing.domInteractive  <span class="comment">//  浏览器完成解析并且所有 HTML 和 DOM 构建完毕timing.domContentLoadedEventStart //DOM 解析完成后，网页内资源加载开始的时间</span></span><br><span class="line">timing.domContentLoadedEventEnd <span class="comment">//DOM 解析完成后，网页内资源加载完成的时间（如 JS 脚本加载执行完毕）</span></span><br><span class="line">timing.domComplete <span class="comment">//网页上所有资源（图片等） 下载完成,且准备就绪的时间</span></span><br></pre></td></tr></table></figure><blockquote><p>以上定义来自<a href="https://developers.google.com/web/fundamentals/performance/critical-rendering-path/measure-crp?hl=zh-cn" target="_blank" rel="noopener">chrome官方文档</a>，在其它环境下也许会有差异，从测试结果看，下面的build时间在android+微信环境中一直是0，对此可能是因为渲染机制差别，此处不做深入测试。除osx+chrome之外环境的数据仅作参考。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">build = timing.domComplete - timing.domContentLoadedEventStart <span class="comment">//间隔记录网页内资源加载和呈现时间。</span></span><br><span class="line">complete = timing.domComplete - timing.domLoading <span class="comment">//页面接收到数据开始到呈现完毕的总时间。</span></span><br></pre></td></tr></table></figure><h2 id="场景1，内嵌至css文件中" class="post-heading"><a href="#场景1，内嵌至css文件中" class="headerlink" title="场景1，内嵌至css文件中"></a>场景1，内嵌至css文件中<a class="post-anchor" href="#场景1，内嵌至css文件中" aria-hidden="true"></a></h2><h4 id="1、原生引入图片链接做背景图" class="post-heading"><a href="#1、原生引入图片链接做背景图" class="headerlink" title="1、原生引入图片链接做背景图"></a>1、原生引入图片链接做背景图<a class="post-anchor" href="#1、原生引入图片链接做背景图" aria-hidden="true"></a></h4><p>一张大小为<strong>50kb</strong>的<strong>jpg格式</strong>图片，应用到9x15=135个dom做背景图，模拟雪碧图的模式，多个节点引用同一张图片做背景，（示例）如图。<br><img src="https://img10.360buyimg.com/ling/jfs/t1/60942/35/2315/506501/5d09e94fEcf00b0ee/026ef7ade10bfc77.png" alt="img"><br><code>测试环境</code>：Mac OS X EI Capitan 10.xx + Chrome 48.xx<br><code>其它辅助测试机器</code>： iPhone 6 plus iOS 9.xx； 魅族Note Android 4.xx</p><blockquote><p>实际使用过程中，其它版本和机型的Android手机还有待测试</p></blockquote><p>关闭缓存状态下，build:150ms | complete: 200ms（总时间受网络状态等因素影响，数据做比较用）<br><img src="https://img14.360buyimg.com/ling/jfs/t1/40929/14/6963/34473/5d09e967Ead9ecea2/4a2924c60152afb3.png" alt="img"></p><p>开启缓存状态下，build: 7ms | complete: 59ms（包括以下稳定状态下多次测试的平均值，截图为最接近平均值的状态，默认数据来自Mac+Chrome[48.XX版本]）</p><p><img src="https://img10.360buyimg.com/ling/jfs/t1/64822/24/2328/33611/5d09e981E98c27128/6640b7872ee33c70.png" alt="img"></p><table><thead><tr><th style="text-align:left">测试环境</th><th style="text-align:center">build(单位:ms)</th><th style="text-align:center">complete(单位:ms)</th></tr></thead><tbody><tr><td style="text-align:left">OS X+Chrome</td><td style="text-align:center">7</td><td style="text-align:center">59</td></tr><tr><td style="text-align:left">iOS+微信</td><td style="text-align:center">45</td><td style="text-align:center">90</td></tr><tr><td style="text-align:left">OS X+Safari</td><td style="text-align:center">50</td><td style="text-align:center">100</td></tr><tr><td style="text-align:left">Android+微信</td><td style="text-align:center">0</td><td style="text-align:center">120</td></tr></tbody></table><h4 id="2、引入base64格式图片做背景图" class="post-heading"><a href="#2、引入base64格式图片做背景图" class="headerlink" title="2、引入base64格式图片做背景图"></a>2、引入base64格式图片做背景图<a class="post-anchor" href="#2、引入base64格式图片做背景图" aria-hidden="true"></a></h4><p>将上面50kb大小的jpg图片转换为base64格式，加在css文件中。</p><p>关闭缓存状态下，build:80ms | complete: 280ms</p><p><img src="https://img14.360buyimg.com/ling/jfs/t1/47665/35/2809/35245/5d09e99cE727ed7b9/a74dee014fdbb6d8.png" alt="img"><br>开启缓存状态下，build: 160ms | complete: 210ms</p><p><img src="https://img10.360buyimg.com/ling/jfs/t1/37113/3/12618/34429/5d09e9aeEe8d8bd6d/60029ff04aa43c5c.png" alt="img"></p><table><thead><tr><th style="text-align:left">测试环境</th><th style="text-align:center">build(单位:ms)</th><th style="text-align:center">complete(单位:ms)</th></tr></thead><tbody><tr><td style="text-align:left">OS X+chrome</td><td style="text-align:center">160</td><td style="text-align:center">210</td></tr><tr><td style="text-align:left">iOS+微信</td><td style="text-align:center">35</td><td style="text-align:center">100</td></tr><tr><td style="text-align:left">OS X+Safari</td><td style="text-align:center">9</td><td style="text-align:center">90</td></tr><tr><td style="text-align:left">Android+微信</td><td style="text-align:center">12</td><td style="text-align:center">150</td></tr></tbody></table><h4 id="3、调整图片体积" class="post-heading"><a href="#3、调整图片体积" class="headerlink" title="3、调整图片体积"></a>3、调整图片体积<a class="post-anchor" href="#3、调整图片体积" aria-hidden="true"></a></h4><p>调整上面图片的（压缩品质）体积，base64化后，对应的css文件大小也跟着改变</p><table><thead><tr><th style="text-align:left">图片大小</th><th style="text-align:center">10kb</th><th style="text-align:center">20kb</th><th style="text-align:center">45kb</th><th style="text-align:center">100kb</th><th style="text-align:center">180kb</th></tr></thead><tbody><tr><td style="text-align:left">对应css文件大小</td><td style="text-align:center">27kb</td><td style="text-align:center">42kb</td><td style="text-align:center">76kb</td><td style="text-align:center">150kb</td><td style="text-align:center">260kb</td></tr><tr><td style="text-align:left">Rendering时间</td><td style="text-align:center">30ms</td><td style="text-align:center">46ms</td><td style="text-align:center">81ms</td><td style="text-align:center">156ms</td><td style="text-align:center">258ms</td></tr></tbody></table><p><img src="https://img13.360buyimg.com/ling/jfs/t1/50988/36/2826/32577/5d09e9c2E6e60566e/4b3823c5550e3e95.png" alt="img"></p><h4 id="4、调整引用次数" class="post-heading"><a href="#4、调整引用次数" class="headerlink" title="4、调整引用次数"></a>4、调整引用次数<a class="post-anchor" href="#4、调整引用次数" aria-hidden="true"></a></h4><p>50kb大小的图片，base64化后，调整引用图片做背景图的dom的个数</p><table><thead><tr><th style="text-align:left">引用次数</th><th style="text-align:center">10</th><th style="text-align:center">20</th><th style="text-align:center">50</th><th style="text-align:center">100</th><th style="text-align:center">135</th></tr></thead><tbody><tr><td style="text-align:left">Rendering时间</td><td style="text-align:center">15ms</td><td style="text-align:center">19ms</td><td style="text-align:center">44ms</td><td style="text-align:center">74ms</td><td style="text-align:center">83ms</td></tr></tbody></table><p><img src="https://img14.360buyimg.com/ling/jfs/t1/67837/13/2312/28633/5d09e9d6Ed242232d/cc7a68c662172862.png" alt="img"></p><h4 id="分析和小结：" class="post-heading"><a href="#分析和小结：" class="headerlink" title="分析和小结："></a>分析和小结：<a class="post-anchor" href="#分析和小结：" aria-hidden="true"></a></h4><p>在OSX+Chrome环境下，将50kb的图片base64后放入样式中，build过程拉长了约20倍，使用Timeline工具可以看到，计算样式阻塞了整个过程。</p><p><img src="https://img13.360buyimg.com/ling/jfs/t1/44335/24/6976/44212/5d09e9ebEc794676b/741d84bef8e6b762.png" alt="img"></p><ol><li>比起直接引入图片地址，css文件中引入base64格式的图片对样式渲染的性能消耗明显，如果大量使用，会带来耗电和发热的问题，需谨慎使用。</li><li>Rendering消耗的时间同css文件大小、引用次数几乎成正比（未测试其它极限情况），在网络条件优质的4G环境，50~70ms的RTT(往返时延）情况下，通常移动网络的状况会更差，对于首屏优化，合适的使用还是很值得的。</li><li>图片转成base64编码后，文档大小较原文件大了一些，而经过 gzip 后两者几乎没有区别。</li></ol><h2 id="场景2，内嵌至js文件中" class="post-heading"><a href="#场景2，内嵌至js文件中" class="headerlink" title="场景2，内嵌至js文件中"></a>场景2，内嵌至js文件中<a class="post-anchor" href="#场景2，内嵌至js文件中" aria-hidden="true"></a></h2><h4 id="1、原生方式直接加载多张图片" class="post-heading"><a href="#1、原生方式直接加载多张图片" class="headerlink" title="1、原生方式直接加载多张图片"></a>1、原生方式直接加载多张图片<a class="post-anchor" href="#1、原生方式直接加载多张图片" aria-hidden="true"></a></h4><p>大小10~70kb共9张图片。总大小约300kb</p><p>关闭缓存：build: 300ms | complete: 310ms</p><p><img src="https://img30.360buyimg.com/ling/jfs/t1/83973/8/2300/68259/5d09ea08Ee9a00498/2c7ef6abbab64452.png" alt="img"><br>开启缓存：build: 110ms | complete: 120ms</p><p><img src="https://img20.360buyimg.com/ling/jfs/t1/80762/39/2369/68288/5d09ea1eEc24db889/eb1630b74fb7cf74.png" alt="img"></p><table><thead><tr><th style="text-align:left">测试环境</th><th style="text-align:center">build(单位:ms)</th><th style="text-align:center">complete(单位:ms)</th></tr></thead><tbody><tr><td style="text-align:left">OS X+Chrome</td><td style="text-align:center">110</td><td style="text-align:center">120</td></tr><tr><td style="text-align:left">iOS+微信</td><td style="text-align:center">50</td><td style="text-align:center">100</td></tr><tr><td style="text-align:left">OS X+Safari</td><td style="text-align:center">148</td><td style="text-align:center">150</td></tr><tr><td style="text-align:left">Android+微信</td><td style="text-align:center">50</td><td style="text-align:center">100</td></tr></tbody></table><h4 id="2、转换成base64格式，合并请求" class="post-heading"><a href="#2、转换成base64格式，合并请求" class="headerlink" title="2、转换成base64格式，合并请求"></a>2、转换成base64格式，合并请求<a class="post-anchor" href="#2、转换成base64格式，合并请求" aria-hidden="true"></a></h4><p>将上面的图片转成base64后，放在js文件中，加载进来。</p><p>关闭缓存：build: 0ms | complete: 400ms</p><p><img src="https://img12.360buyimg.com/ling/jfs/t1/75863/30/2285/87027/5d09ea32E5ab77220/129a8c98f2e044ac.png" alt="img"></p><p>开启缓存：build: 0ms | complete: 80ms</p><p><img src="https://img20.360buyimg.com/ling/jfs/t1/48464/32/2768/84493/5d09ea44E15fbc8b8/ab8ec033c28ac6b4.png" alt="img"></p><table><thead><tr><th style="text-align:center">测试环境</th><th style="text-align:center">build(单位:ms)</th><th style="text-align:center">complete(单位:ms)</th></tr></thead><tbody><tr><td style="text-align:center">OSX+Chrome</td><td style="text-align:center">110</td><td style="text-align:center">120</td></tr><tr><td style="text-align:center">iOS+微信</td><td style="text-align:center">0</td><td style="text-align:center">35</td></tr><tr><td style="text-align:center">OS X+Safari</td><td style="text-align:center">7</td><td style="text-align:center">70</td></tr><tr><td style="text-align:center">Android+微信</td><td style="text-align:center">0</td><td style="text-align:center">250</td></tr></tbody></table><h4 id="3、比较不同网速下同步请求和合并请求的加载效率" class="post-heading"><a href="#3、比较不同网速下同步请求和合并请求的加载效率" class="headerlink" title="3、比较不同网速下同步请求和合并请求的加载效率"></a>3、比较不同网速下同步请求和合并请求的加载效率<a class="post-anchor" href="#3、比较不同网速下同步请求和合并请求的加载效率" aria-hidden="true"></a></h4><p>使用上述1、2的测试demo分别在3G、4G网速条件下测试结果如下：</p><ul><li>在网络环境差的情况下，合并请求明显缩短了整个加载时间；</li><li>在网络环境较好的WIFI和4G下则差别不大。</li></ul><table><thead><tr><th style="text-align:center">测试环境</th><th style="text-align:center">图片直接加载 complete(单位:ms)</th><th style="text-align:center">base64合并请求 complete(单位:ms)</th></tr></thead><tbody><tr><td style="text-align:center">3G</td><td style="text-align:center">6000</td><td style="text-align:center">4500</td></tr><tr><td style="text-align:center">4G</td><td style="text-align:center">450</td><td style="text-align:center">400</td></tr><tr><td style="text-align:center">WIFI</td><td style="text-align:center">320</td><td style="text-align:center">340</td></tr></tbody></table><p><img src="https://img12.360buyimg.com/ling/jfs/t1/49305/12/2852/29446/5d09ea59E5b71c578/b19029313815f1cf.png" alt="img"></p><h4 id="分析和小结：-1" class="post-heading"><a href="#分析和小结：-1" class="headerlink" title="分析和小结："></a>分析和小结：<a class="post-anchor" href="#分析和小结：-1" aria-hidden="true"></a></h4><p>base64后的的js资源达381kb，在一个线程里加载，消耗大量时间，从统计结果看，在渲染性能差异上并没有场景1那么明显。<br>但有缓存的情况下，页面渲染完成的速度甚至更快。<br>从Timeline里看到细节，解析这个近400kb的js文件对整个渲染过程造成了一定压力，不过总共40ms的解析时间是完全可以接受的。</p><p><img src="https://img10.360buyimg.com/ling/jfs/t1/77240/40/2229/63120/5d09ea6eE133b4fe4/3d310d7007ce1754.png" alt="img"></p><ol><li>从html里直直接引用图片链接和base64图片对渲染性能的影响几乎没有区别，在网络条件差的情况下，合并请求却能大大提高加载效率；</li><li>直接引用至html，无法缓存，将base64后的图片资源放在js文件中管理，方便设置缓存。</li><li>有一个缺点就是图片资源base64化需要扩展构建工具来支持。</li></ol><h2 id="使用建议" class="post-heading"><a href="#使用建议" class="headerlink" title="使用建议"></a>使用建议<a class="post-anchor" href="#使用建议" aria-hidden="true"></a></h2><ol><li><p>图片资源的base64编码进css文件会带来一定的性能消耗，需谨慎使用。</p></li><li><p>将图片资源编码进js文件中，管理和预加载H5应用的图片资源，合理的合并请求可以大大提高页面体验。</p></li></ol><div class="post-tags" style="display:none"><a href="/tags/base64/">base64</a> <a href="/tags/h5/">h5</a></div><div class="post-categories" style="display:none"><a href="/cates/性能优化/">性能优化</a></div><div class="post-announce">感谢您的阅读，本文由 <a href="//aotu.io">凹凸实验室</a> 版权所有。如若转载，请注明出处：凹凸实验室（<a href="https://aotu.io/notes/2016/03/04/can-we-use-base64-in-h5-webapps/">https://aotu.io/notes/2016/03/04/can-we-use-base64-in-h5-webapps/</a>）</div><div class="post-revision"><i class="fa fa-clock-o"></i> <time class="post-updated" datetime="2020-04-28T03:04:50.291Z">上次更新：2020-04-28 11:04:50</time></div></div><div class="post-nav"><div class="post-nav-next"><a href="/notes/2016/03/09/img-loading-optimization-in-mobile/" title="让图片加载这件事儿变得更美好">让图片加载这件事儿变得更美好 <i class="fa fa-chevron-right"></i></a></div><div class="post-nav-prev"><a href="/notes/2016/03/01/createjs-get-started/" title="createjs开发入门"><i class="fa fa-chevron-left"></i> createjs开发入门</a></div></div><div class="post-comments" id="comments"></div><script>var gitalkOpts={id:"bm90ZXMvMjAxNi8wMy8wNC9jYW4td2UtdXNlLWJhc2U2NC1pbi",owner:"o2team",repo:"o2team.github.io",title:"图片资源Base64化在H5页面里有用武之地吗？",body:"https://aotu.io/notes/2016/03/04/can-we-use-base64-in-h5-webapps/index.html\n\n本文使用performance接口和Timeline工具，测试和分析了不同场景下引用base64化的图片资源对渲染性能的影响，旨在抛砖引玉，找出图片资源的base64化在H5应用中使用的可行性。",clientID:"3c4d153e6874260f9c7e",clientSecret:"dd44012504c6168bc05b9266e0554bb28c62ce15",admin:["Simbachen"]}</script></article></div><aside class="mod-side" id="sidebar"><div class="mod-side-sec aotuwx"><img class="aotuwx-qrcode" src="/img/qrcode.jpg" alt="关注我们"><div class="aotuwx-slogan">每周推送精选技术文章</div></div><div class="mod-side-sec works"><div class="mod-side-sec-hd"><h2>服务/产品</h2></div><div class="mod-side-sec-bd"><ul class="mod-side-list"><li><a href="//taro.jd.com" target="_blank" title="Taro">Taro</a></li><li><a href="//taro-ui.jd.com" target="_blank" title="Taro-UI">Taro-UI</a></li><li><a href="//taro-ext.jd.com" target="_blank" title="Taro 物料市场">Taro 物料市场</a></li><li><a href="//taro-club.jd.com" target="_blank" title="Taro 官方论坛">Taro 官方论坛</a></li><li><a href="//cases.aotu.io/mobi/maga.html" target="_blank" title="拇指期刊">拇指期刊</a></li><li><a href="//athena.aotu.io/" target="_blank" title="Athena">Athena</a></li><li><a href="//guide.aotu.io/" target="_blank" title="前端代码规范">前端代码规范</a></li><li><a href="//halojs.aotu.io/" target="_blank" title="HaloJS">HaloJS</a></li><li><a href="//sign.aotu.io/" target="_blank" title="邮件签名工具">邮件签名工具</a></li><li><a href="//mac.aotu.io/" target="_blank" title="MAC全栈环境">MAC全栈环境</a></li><li><a href="//xcel.aotu.io" target="_blank" title="Excel Filter">Excel Filter</a></li><li><a href="//aotu.jd.com/share/" target="_blank" title="凹凸公开课">凹凸公开课</a></li><li><a href="//at.aotu.io" target="_blank" title="AT-UI">AT-UI</a></li></ul></div></div><div class="mod-side-sec favlinks"><div class="mod-side-sec-hd"><h2>友情链接</h2></div><div class="mod-side-sec-bd"><ul class="mod-side-list"><li><a href="https://www.cloudbase.net" target="_blank" title="小程序·云开发"><img style="width:22px;vertical-align:middle" src="https://img20.360buyimg.com/ling/jfs/t1/57175/5/15617/50216/5dca6729E00cdff5d/631622525425290e.png">小程序·云开发</a></li><li><a href="https://ling.jd.com" target="_blank" title="京东羚珑智能设计">羚珑智能设计</a></li><li><a href="https://jdc.jd.com" target="_blank" title="京东设计中心">JDC京东设计中心</a></li><li><a href="http://dopro.io/" target="_blank" title="腾讯 Deep Ocean">Deep Ocean</a></li><li><a href="http://fex.baidu.com" target="_blank" title="百度Web前端研发部">百度FEX</a></li><li><a href="http://taobaofed.org" target="_blank" title="淘宝前端团队">淘宝FED</a></li><li><a href="http://tgideas.qq.com" target="_blank" title="腾讯互娱设计中心">TGIdeas</a></li><li><a href="http://isux.tencent.com" target="_blank" title="腾讯SNG设计中心">ISUX</a></li><li><a href="http://cdc.tencent.com" target="_blank" title="腾讯用户研究与体验设计中心">CDC</a></li><li><a href="http://ued.ctrip.com" target="_blank" title="携程设计委员会">携程UED</a></li><li><a href="https://uiiiuiii.com/" target="_blank" title="优优教程网">优优教程网</a></li><li><a href="https://www.designup.cn/" target="_blank" title="Designup">Designup</a></li><li><a href="http://eux.baidu.com/" target="_blank" title="百度EUX">百度EUX</a></li></ul></div></div></aside></div></div><div class="mod-backtop" id="backTop"><i class="fa fa-long-arrow-up"></i></div><footer class="mod-ft" id="footer"><div class="grid"><ul class="mod-ft-links"><li><a href="/atom.xml"><i class="fa fa-rss"></i></a></li><li><a href="https://github.com/o2team/o2team.github.io" target="_blank"><i class="fa fa-github-alt"></i></a></li></ul><div class="mod-ft-sec mod-ft-copyright"><p>Designed by <a href="http://aotu.io" target="_blank">凹凸实验室</a> @<a target="_blank" href="http://jdc.jd.com">京东用户体验设计部</a></p><p>Copyright &copy; 2020. All Rights Reserved.</p><p><a href="http://www.miibeian.gov.cn/" target="_blank">粤ICP备15077732号-2</a></p></div></div></footer><script src="/js/bundle/core.js"></script><script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script><script src="/js/post_wx_share.js"></script><script src="/js/bundle/gitalk.js"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="//hm.baidu.com/hm.js?e850b980d029480b092fdd7503c3f8de";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script type="text/javascript" src="https://tajs.qq.com/stats?sId=53685723" charset="UTF-8"></script></body></html>